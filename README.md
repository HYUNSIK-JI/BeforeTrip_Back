 # ì—¬í–‰ì „ë‚ 

   

   > ì—¬í–‰ ì „ í•„ìˆ˜ ì²´í¬ì‚¬í•­ ì •í˜•í™”ëœ ì‚¬ì´

   

   ## í”„ë¡œì íŠ¸ ì†Œê°œ
   
   - ğŸ—“

     í”„ë¡œì íŠ¸ ê¸°ê°„

     - 2023.03.01 (ìˆ˜) ~ 2022.03.08(ìˆ˜)

   - ğŸ“š ì‚¬ìš©í•œ ê¸°ìˆ  STACKS

   - <div style="text-align:center">    
     <img src="https://img.shields.io/badge/Python-red?style=flat-square&logo=Python&logoColor=white"/>
     <img src="https://img.shields.io/badge/Docker-blue?style=flat-square&logo=Docker&logoColor=white"/>
     <img src="https://img.shields.io/badge/Mysql-green?style=flat-square&logo=Mysql&logoColor=white"/>
     <img src="https://img.shields.io/badge/Shell-red?style=flat-square&logo=Shell&logoColor=white"/>
     <img src="https://img.shields.io/badge/Django-red?style=flat-square&logo=DJANGO&logoColor=white"/>
     <img src="https://img.shields.io/badge/Nginx-blue?style=flat-square&logo=Nginx&logoColor=white"/>
     <img src="https://img.shields.io/badge/AWS-Black?style=flat-square&logo=AWS&logoColor=blue"/>
     </div>

     


     ### ğŸ“Œ **BackEnd**

     - DRF(Django REST Framework)ë¥¼ í†µí•œ REST API êµ¬í˜„ ë° í”„ë¡ íŠ¸ì—”ë“œ í†µì‹ 
     - ë°°í¬ ì£¼ì†Œ:https://www.beforetripsback.shop/users/register/
   

   ## ëª¨ë¸ êµ¬ì¡°, ERD ì‘ì„±

   

   ![ìµœí”„-erd2](https://user-images.githubusercontent.com/59475851/225585512-72b8f002-e049-434d-b560-fa05759363f5.jpg)


### âš›ï¸ ê¸°ëŠ¥ ì„¤ê³„

- íšŒì›ê´€ë¦¬
  - íšŒì›ê°€ì…
  - ë¡œê·¸ì¸
  - ë¡œê·¸ì•„ì›ƒ
- ì»¤ë®¤ ë‹ˆí‹°
  - ì—¬í–‰ì§€ ê¸€ í›„ê¸° ì‘ì„± / ì‚­ì œ / ìˆ˜ì •
  - í›„ê¸° ê¸€ ì¢‹ì•„ìš” / ì·¨ì†Œ
  - ì—¬í–‰ì§€ ëŒ“ê¸€ ì‘ì„± / ì‚­ì œ / ìˆ˜ì •
- ì—¬í–‰ì§€ ì •ë³´
  - êµ­ê°€ë³„ ê¿€íŒ ì •ë³´ ì‘ì„± / ì‚­ì œ / ìˆ˜ì •
  - ê²Œì‹œê¸€ ì¢‹ì•„ìš” / ì·¨ì†Œ
  - ê¿€íŒ ì •ë³´ ëŒ“ê¸€ ì‘ì„±/ ì‚­ì œ / ìˆ˜ì •
  - ì¢‹ì•„ìš” ë§ì€ ìˆœìœ¼ë¡œ ê¿€íŒ ì •ë³´ ì¡°íšŒ

### API ë¬¸ì„œ
| ì•± | ì´ë¦„ | í´ë˜ìŠ¤ ì´ë¦„ | ë©”ì†Œë“œ | ìš”ì²­ URL | ìƒì„¸ ë‚´ìš© | ì°¸ê³ ì‚¬í•­ | API ìš”ì²­ | API ê°’ |


### âœ… ë‚´ê°€ ë‹´ë‹¹í•œ ê¸°ëŠ¥

> **ğŸ’» ë©”ì¸ Role - BackEnd: BackEnd ì „ì²´ ì½”ë“œ ì‘ì„±**

- êµ¬í˜„ ì£¼ìš” ê¸°ëŠ¥
  - CRUD: ì—¬í–‰ì§€ ê¸€ í›„ê¸° / ëŒ“ê¸€ / ì¢‹ì•„ìš”
  - ê¸°ì¡´ Django sqlite3 ë°ì´í„° ë² ì´ìŠ¤ë¥¼ MYSQLë¡œ ì „í™˜
  - User ëª¨ë¸ ì™€ ê²Œì‹œê¸€ ëª¨ë¸ M:N ê´€ê³„ ì„¤ì • ê²Œì‹œê¸€ ì¢‹ì•„ìš” êµ¬í˜„
  - ê²Œì‹œê¸€ ëª¨ë¸ ê³¼ ëŒ“ê¸€ M : N ê´€ê³„ ì„¤ì • ëŒ“ê¸€ ì‘ì„± ë° ì¡°íšŒ êµ¬í˜„
  - ê²Œì‹œê¸€ ì¢‹ì•„ìš”ë¥¼ annotate ORM ê¸°ëŠ¥ìœ¼ë¡œ ë§ì€ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ê¿€íŒ ì •ë³´ ì¡°íšŒ
  - ë„ì»¤ë¥¼ í™œìš©í•˜ì—¬ Nginx, MYSQL, Django ì»¨í…Œì´ë„ˆ ìƒì„± EC2 í™˜ê²½ì— ë„ì»¤ ì„¤ì¹˜í›„ ë°°í¬ ì§„í–‰

## ê°œë°œ ì´ìŠˆ

### 1. JWT ë¡œê·¸ì¸ ìœ„í•œ ì¿ í‚¤ ì„¤ì •

### â‰ï¸ ì—ëŸ¬ ë©”ì„¸ì§€

ì¿ í‚¤ ì„¤ì • ì¤‘ SAME_SITE ë¼ëŠ” ì†ì„±ì´ ì¡´ì¬ í•œë‹¤.

ì˜ˆì „ì—ëŠ” ê¸°ë³¸ ê°’ì´ None ì´ì˜€ë‹¤ê³  í•œë‹¤. 

í•˜ì§€ë§Œ ì¿ í‚¤ ì„¤ì •ì´ ë³´ì•ˆ ì ì¸ ì´ìœ  ë¡œ ê¸°ë³¸ ê°’ì´ LAXìœ¼ë¡œ ë³€ê²½ ë˜ì–´ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì¿ í‚¤ë¥¼ ë°›ì•„ ë“¤ì´ì§€ ëª»í•˜ëŠ” ì´ìŠˆê°€ ì¡´ì¬ í–ˆë‹¤.
![image](https://user-images.githubusercontent.com/59475851/225653671-47619d65-7c45-4dae-9d0b-495493b904a9.png)
![image](https://user-images.githubusercontent.com/59475851/225655594-da2cbf90-6c6c-4083-8f14-baf2de025752.png)
![image](https://user-images.githubusercontent.com/59475851/225653743-0e6ba570-7ae7-4534-b064-b570851ff875.png)


### â­•ï¸ í•´ê²° ë°©ë²•

1. ì¿ í‚¤ ì„¤ì •ì„ ì»¤ìŠ¤í…€ ì§„í–‰

![image](https://user-images.githubusercontent.com/59475851/225657429-f095e07d-a798-4189-90f5-766a750e8c4b.png)

2. HTTPS ì„¤ì •

![image](https://user-images.githubusercontent.com/59475851/225658181-42d362c2-aab7-4b4a-aab5-ad93daea58f3.png)


### 2. CORS

### â‰ï¸ ì—ëŸ¬ ë©”ì„¸ì§€

![CORS](https://user-images.githubusercontent.com/59475851/225637095-3f46d089-5af7-4223-82eb-499a3f286b2d.PNG)


### â­•ï¸ í•´ê²° ë°©ë²•

1. Nginx ì„¤ì • íŒŒì¼ì—ì„œ 

![CORS3](https://user-images.githubusercontent.com/59475851/225641504-f3d7f164-c910-4d76-8f58-59f4fef0a8ef.PNG)

ì•„ë˜ì™€ ê°™ì´ í—¤ë”ì— ê°’ì„ ì¶”ê°€  í•˜ë©´ í•´ê²° ë˜ì—ˆë‹¤.



### 3. Mysql ì„¤ì •ì´ìŠˆ

### â‰ï¸ ì—ëŸ¬ ë©”ì„¸ì§€

1. ìœ ì € ëª¨ë¸ì´ AbstractBaseUser ì˜ì¡´ -> migrateê°€ ë°œìƒ í•˜ì§€ ì•Šì€ í˜„ìƒ ë°œìƒ

![image](https://user-images.githubusercontent.com/59475851/225665781-efdde7c6-bac8-42cc-a780-6864faad3379.png)

![image](https://user-images.githubusercontent.com/59475851/225665645-90590e9d-361f-47b2-bc48-f0a9af280486.png)


### â­•ï¸ í•´ê²° ë°©ë²•

![image](https://user-images.githubusercontent.com/59475851/225666059-298e40a9-77be-4092-aeb6-f32847673d9f.png)

![image](https://user-images.githubusercontent.com/59475851/225666243-1c0d2064-8966-4368-a6a9-83b405432daa.png)

ìœ„ì˜ ì‚¬ì§„ê³¼ ê°™ì´ ì£¼ì„ ì²˜ë¦¬í•˜ê²Œ ë˜ë©´ migrateë¡œ mysqlê³¼ ì—°ë™ ê°€ëŠ¥í•˜ê²Œ ë˜ì—ˆë‹¤. (MYSQL WORKbench)


### 4. ë°°í¬ ì´í›„ HTTPSì„ ìœ„í•œ nginx ì„¤ì • ì´ìŠˆ

### â‰ï¸ ì—ëŸ¬ ë©”ì„¸ì§€

1. nginx ì„¤ì • íŒŒì¼ì¸ default.conf ë‚´ìš© ì¤‘ HTTPSì„ ìœ„í•œ ì„¤ì • ì½”ë“œ

   ssl_certificate /etc/letsencrypt/live/www.beforetripsback.shop/fullchain1.pem;

   ssl_certificate_key /etc/letsencrypt/live/www.beforetripsback.shop/privkey1.pem;

   íŒŒì¼ì´ ì¡´ì¬ í•˜ì§€ ì•Šì•„ nginx ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ ë˜ì§€ ì•ŠëŠ” í˜„ìƒ ë°œìƒ



### â­•ï¸ í•´ê²° ë°©ë²•

1. HTTPS ì„ ì„¤ì • í•˜ê¸° ìœ„í•´ì„  ê¸°ë³¸ì ìœ¼ë¡œ Nginx ì»¨í…Œì´ë„ˆê°€ ë¬´ì¡°ê±´ ì‹¤í–‰ ë˜ì–´ì•¼ í–ˆë‹¤.
2. ssl ì„¤ì • ë¶€ë¶„ì„ ì£¼ì„ ì²˜ë¦¬í•˜ê³ ,  nginxì„ ì‹¤í–‰ ì‹œì¼°ë‹¤.
3. ì´í›„ Docker hubì—ëŠ” certbot ê³µì‹ imageê°€ ì¡´ì¬í–ˆê³  ì´ë¥¼ ì´ìš©í•˜ì—¬ ì¸ì¦ì„œì„ ë°œê¸‰
4. ë°œê¸‰ ë°›ì€ ì¸ì¦ì„œë¥¼ nginx ì»¨í…Œì´ë„ˆê°€ ë¶ˆëŸ¬ì˜¤ëŠ” ë””ë ‰í„°ë¦¬ì— ì¸ì¦ì„œë¥¼ ë³µì‚¬
5. í•˜ì§€ë§Œ ì¸ì¦ì„œ ì‹¬ë³¼ë¦­ ë§í¬ê°€ ì¡´ì¬ í•˜ë¯€ë¡œ ì›ë³¸ ë³µì‚¬ëŠ” ë¶ˆê°€í–ˆê³ , ë³µì‚¬ë³¸ì„ ì»¨í…Œì´ë„ˆì— ë³µì‚¬
6. ì£¼ì„ í–ˆë˜ nginx ì„¤ì • ë¶€ë¶„ì„ í’€ê³  í”„ë¡ì‹œ ì„œë²„ ë¶€ë¶„ì„ http://example.com ìœ¼ë¡œ ìˆ˜ì •
7. nginx ì»¨í…Œì´ë„ˆ ì¬ ì‹¤í–‰



### 5.ë°°í¬ ì´í›„ Static íŒŒì¼ ì°¾ì•„ ì˜¤ì§€ ëª»í•˜ëŠ” í˜„ìƒ

### â‰ï¸ ì—ëŸ¬ ë©”ì„¸ì§€

1. Static íŒŒì¼ì„ ì½ì–´ ì˜¤ì§€ ëª»í•´ css, js ë“± í™ˆí˜ì´ì§€ ê°€ ê¹¨ì§€ëŠ” í˜„ìƒ ë°œìƒ

![static4](https://user-images.githubusercontent.com/59475851/225648023-02112e8b-60cb-474e-aa39-68fa79b2006c.PNG)


### â­•ï¸ í•´ê²° ë°©ë²•
nginx ì„¤ì • íŒŒì¼ ì½”ë“œ ì¶”ê°€

![static1](https://user-images.githubusercontent.com/59475851/225648076-a5cdfdbf-6400-49ee-adfc-b452680ba779.PNG)


django settings.py ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ ì½”ë“œ ì¶”ê°€
![static2](https://user-images.githubusercontent.com/59475851/225648123-678530e4-5214-4580-90ec-1bfa8f5e979a.PNG)
![static3](https://user-images.githubusercontent.com/59475851/225648136-3cbbf8c1-965b-4bf1-81b8-bb701608e6e4.PNG)

ë„ì»¤ ì»¨í…Œì´ë„ˆ ì„¤ì • ì¶”ê°€

![static5](https://user-images.githubusercontent.com/59475851/225649170-35ac4bfe-566b-42c5-9b85-71900d525055.PNG)

## í”„ë¡œì íŠ¸ í›„ê¸°

ì²˜ìŒ ë°±ì—”ë“œ ë¶€ë¶„ì„ ë§¡ì•˜ì„ë• ë§‰ë§‰ í•˜ì˜€ë‹¤. django rest framework ë¶€ë¶„ë„ ì˜ ëª¨ë¥´ê³  

ì´ì œê» ì“°ì§€ ì•Šì•˜ë˜ ê¸°ìˆ ì„ ì¨ì•¼ í•˜ëŠ” ìƒí™© ì´ì˜€ê¸° ë•Œë¬¸ì´ì˜€ë‹¤.

ìµìˆ™í•˜ì§€ ì•Šì•„ í˜ë“  ì ì´ ë§ì•˜ì§€ë§Œ ì•¼ìƒí•™ìŠµì„ í†µí•´ ìƒˆë¡œìš´ ê¸°ìˆ ì„ í•™ìŠµí•´ë‚˜ê°€ëŠ” ì—­ëŸ‰ ë˜í•œ ê¸¸ëŸ¬ ë‚˜ê°ˆ ìˆ˜ ìˆì—ˆë‹¤.

ìƒˆë¡œìš´ ê¸°ìˆ , í”„ë ˆì„ì›Œí¬ ë“±ì„ í•™ìŠµí•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ ìì‹ ê°ì„ ì–»ì„ìˆ˜ ìˆì—ˆê³  ë°±ì—”ë“œ ê°œë°œìë¥¼ ì§€ë§í•˜ëŠ”

ì§€ë§ìƒìœ¼ë¡œì„œ ë°±ì—”ë“œì—ì„œ í•„ìˆ˜ì ìœ¼ë¡œ ë°°ì›Œì•¼ í•  ë¶€ë¶„ì„ ë°°ìš´ê²ƒ ê°™ì•„ ì ì€ ê¸°ê°„ì´ì˜€ì§€ë§Œ ë¿Œë“¯í•œ í”„ë¡œì íŠ¸ ì˜€ë‹¤.
